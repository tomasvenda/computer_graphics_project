<!DOCTYPE html>
<html>
<head>
    <title>JS 3D Physics</title>
    
    <script type="text/javascript" src="common/MV.js"></script>
    <script type="text/javascript" src="common/ammo.js"></script>
    <script type="text/javascript" src="common/quaternion.js"></script>
    <script type="text/javascript" src="ball.js"></script>
    <script id="texture-wgsl" type="x-shader/x-wgsl" src="external_image.wgsl"></script>
    
    <script id="wgsl" type="x-shader">
    struct Uniforms {
        proj: mat4x4f,
        view: mat4x4f,
        model: mat4x4f,
        normal: mat4x4f
    };
    @group(0) @binding(0) var<uniform> uniforms : Uniforms;

    struct VSOut {
        @builtin(position) position: vec4f,
        @location(0) color: vec3f,
    };

    @vertex
    fn main_vs(@location(0) inPos: vec4f, @location(1) inNormal: vec4f) -> VSOut
    {
        const w_i = normalize(vec3(-1.0, 1.75, 1.0));
        let n = normalize((uniforms.normal*inNormal).xyz);
        let k_d = inPos.xyz*0.5 + 0.5;
        var vsOut: VSOut;
        vsOut.position = uniforms.proj*uniforms.view*uniforms.model*inPos;
        vsOut.color = k_d*max(dot(n, w_i), 0.0);
        return vsOut;
    }

    @fragment
    fn main_fs(@location(0) inColor: vec3f) -> @location(0) vec4f
    {
        return vec4f(inColor, 1.0);
    }
    </script>
</head>
<body>
    <canvas id="webgpu-canvas" width="1200" height="675">
        Please use a browser that supports the HTML5 canvas element.
    </canvas>
    <p style="width:1200px; text-align:center">
    <table style="width:1200px; text-align:center">
    <tr>
    <td><b>BALL CONTROL</b></td>
    <td><b>TABLE CONTROL</b></td>
    </tr>
    <tr>
    <td>
    <img src="wasd.svg" style="height:50px" />
    </td>
    <td>
    <img src="arrowkeys.svg" style="height:50px" />
    </td>
    </tr>
    </table>
    </p>
</body>
</html>